import aiohttp
import asyncio
from typing import List, Dict

class VulnerabilityDB:
    def __init__(self):
        self.base_url = "https://services.nvd.nist.gov/rest/json/cves/1.0"

    async def search_vulnerabilities(self, keyword: str) -> List[Dict]:
        async with aiohttp.ClientSession() as session:
            async with session.get(f"{self.base_url}?keyword={keyword}") as response:
                data = await response.json()
                return data.get("result", {}).get("CVE_Items", [])

    async def get_vulnerability_details(self, cve_id: str) -> Dict:
        async with aiohttp.ClientSession() as session:
            async with session.get(f"{self.base_url}?cveId={cve_id}") as response:
                data = await response.json()
                return data.get("result", {}).get("CVE_Items", [{}])[0]